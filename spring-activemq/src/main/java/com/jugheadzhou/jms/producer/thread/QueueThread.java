package com.jugheadzhou.jms.producer.thread;import com.jugheadzhou.jms.util.MqMessageUtil;import lombok.extern.slf4j.Slf4j;import org.springframework.jms.core.JmsTemplate;import org.springframework.jms.core.MessageCreator;import javax.jms.JMSException;import javax.jms.Message;import javax.jms.Session;/** * @description: 发送队列消息的总线 * @author: aishu * @create: 2019-10-24 10:50 */@Slf4jpublic class QueueThread implements Runnable {    private JmsTemplate jmsTemplate;    private String destination;    private Object message;    public QueueThread(JmsTemplate jmsTemplate, String destination, Object message) {        this.jmsTemplate = jmsTemplate;        this.destination = destination;        this.message = message;    }    @Override    public void run() {        log.info("开始发送消息,目的地是{}",this.destination);        synchronized (this.jmsTemplate){            this.jmsTemplate.send(this.destination, new MessageCreator() {                @Override                public Message createMessage(Session session) throws JMSException {                    String msg = MqMessageUtil.Object2String(message);                    log.info("mq-producer-send-message: {}",msg);                    return session.createTextMessage(msg);                }            });        }        log.info("发送消息完成,目的地是{}",this.destination);    }}